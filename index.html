<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EquipStatus</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>EquipStatus</h1>
        <nav>
            <ul>
                <li><img src="enlaces.png" alt="Enlaces"></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="form">
            <h2>Información del estudiante</h2>
            <form id="mensajeForm">
                <label for="telefonoResponsable">Número de teléfono del responsable:</label>
                <input type="tel" id="telefonoResponsable" name="telefonoResponsable" required>

                <label for="nombreEstudiante">Nombre estudiante:</label>
                <input type="text" id="nombreEstudiante" name="nombreEstudiante" required>

                <label for="nombreResponsable">Nombre responsable:</label>
                <input type="text" id="nombreResponsable" name="nombreResponsable" required>

                <label for="equipoReparado">Seleccione el equipo reparado:</label>
                <select id="equipoReparado" name="equipoReparado" required>
                    <option value="tablet">Tablet</option>
                    <option value="laptop">Laptop</option>
                </select>

                <button type="submit">Enviar mensaje</button>
            </form>
            <!-- Contenedor para el flujo de vídeo del escáner QR -->
            <div id="scanner-container"></div>
            <!-- Botón para escanear QR -->
            <button id="scanQR">Escanear código QR</button>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 EquipStatus</p>
    </footer>

    <!-- Script de Quagga.js -->
    <script src="https://cdn.jsdelivr.net/npm/quagga/dist/quagga.min.js"></script>
    <script>
        // Función para inicializar QuaggaJS y manejar la detección de códigos QR
        function iniciarEscaneoQR() {
            Quagga.init({
                inputStream: {
                    name: "Live",
                    type: "LiveStream",
                    target: document.querySelector("#scanner-container"),
                    constraints: {
                        width: 640,
                        height: 480,
                        facingMode: "environment" // Usa la cámara trasera del dispositivo
                    }
                },
                decoder: {
                    readers: ["code_128_reader", "ean_reader", "ean_8_reader", "code_39_reader", "code_39_vin_reader", "codabar_reader", "upc_reader", "upc_e_reader", "i2of5_reader"]
                }
            }, function (err) {
                if (err) {
                    console.error("Error al inicializar Quagga: ", err);
                    return;
                }
                console.log("Quagga inicializado correctamente.");
                Quagga.start();
            });

            Quagga.onDetected(function (result) {
                console.log("Código detectado: ", result.codeResult.code);
                // Aquí puedes realizar las acciones que desees con el código detectado
                // Por ejemplo, llenar algún campo del formulario con el valor del código QR
                document.getElementById('telefonoResponsable').value = result.codeResult.code;
                // Detener el escaneo después de detectar un código
                Quagga.stop();
            });
        }

        // Evento click para iniciar el escaneo de códigos QR
        document.getElementById('scanQR').addEventListener('click', iniciarEscaneoQR);
    </script>
</body>
</html>

